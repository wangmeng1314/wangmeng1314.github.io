<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Technology comes from life and higher than life">
    

    <!--Author-->
    
        <meta name="author" content="HenryMemory">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="我亲爱的Properties文件"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Technology comes from life and higher than life" />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="HenryMemory&#39;s blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>我亲爱的Properties文件 - HenryMemory&#39;s blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>


<body>
    <!-- ad start -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ���浥Ԫ -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9547113709259711"
     data-ad-slot="8833815185"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
    <!-- ad end -->
    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/klugjo/hexo-theme-clean-blog">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>我亲爱的Properties文件</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2016-07-24
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-4 col-lg-offset-2 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/java/">#java</a>


                    
                </div>
                <div class="col-lg-4 col-md-5 post-categories">
                    
                        

<a href="/categories/java基础/">java基础</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Properties文件大家都用过，然而里面的思维我们有没有get到呢？和阿福一起看看吧！</p>
<h4 id="我亲爱的Properties文件"><a href="#我亲爱的Properties文件" class="headerlink" title="我亲爱的Properties文件"></a>我亲爱的Properties文件</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们在写代码的过程中经常在程序中需要用到一些值，对于这些值的管理的方法也是千奇百怪。那么，到底有哪些方法呢？下面，我们就来一起看看。</p>
<h4 id="方法脑暴"><a href="#方法脑暴" class="headerlink" title="方法脑暴"></a>方法脑暴</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先，我们最常想到的就是将其写入到程序中去，我们往往会在代码中新建一个常量类，还会美其名曰”Constant”;见名知意，常量我们都会放在这个里面，但是，需要修改怎么办？怎么办？</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;这时候，我们可以祭出我们java学院派的IO系统，我们可以存储到文件系统中去。在需要的时候读取出来啊，这个想法简直是太美妙了。这里我都想到了，用“key,value”这种类似的格式进行存储，甚至用BufferedWriter和BufferedReader可以一行一行的存，一行一行的读，读出来后首先截断放到一个hashmap中去，至于为何要放到hashmap中去，这个没啥讲究啦！</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;然而，好操心啊！还需要我们编写额外的代码，当然我要是任性直接存入数据库也行啊！但是你不得访问数据库啊！幸运的是，java为我们提供了一种优雅的方法，那就是Properties文件。<br><a id="more"></a></p>
<h4 id="Properties文件用法"><a href="#Properties文件用法" class="headerlink" title="Properties文件用法"></a>Properties文件用法</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;protertis文件的用法到底是怎样的呢？首先，第一步，你得有protertis文件呀，其实在项目的classpath创建其即可。名字随便起，这个见名知意即可。有了文件，我们得先来看看文件内部的存储格式是怎样的？<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># test</div><div class="line">methodName=marryWm</div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我们可以看到，是以key-value形式存储的，而且中间以等号将两边分割开来，好吧，看到这里，突然感觉与我上面提到的方法好像啊，难道，JDK的作者竟然和我有一样想法，事实是怎样的呢，我们去看看！</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;在探究之前先放出到底如何使用的代码吧！<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">prop = <span class="keyword">new</span> Properties();</div><div class="line">InputStream in = FileService.class.getClassLoader().getResourceAsStream(<span class="string">"urlutil.Properties"</span>);</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">	prop.load(in);</div><div class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">	e.printStackTrace();</div><div class="line">&#125;</div><div class="line">String urlString = prop.getProperty(methodName);</div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;有了这段代码，得到key对应的value是没有任何问题了，但是，刚才已经想着去探究了，那只能一探到底喽！</p>
<h4 id="Proterties类实现原理"><a href="#Proterties类实现原理" class="headerlink" title="Proterties类实现原理"></a>Proterties类实现原理</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;首先进入Proterties类的源代码：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public class Properties extends Hashtable<span class="tag">&lt;<span class="name">Object,Object</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;竟然继承了HashTable，看来我们的猜测方向没错。可是我们该从哪里看起呢？我们当然是从其如何加载文件到内存中和我们程序中看起，这个就是我们的切入点！下面来看load方法。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">load</span><span class="params">(InputStream inStream)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    load0(<span class="keyword">new</span> LineReader(inStream));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">load0</span> <span class="params">(LineReader lr)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">    <span class="keyword">char</span>[] convtBuf = <span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">1024</span>];</div><div class="line">    <span class="keyword">int</span> limit;</div><div class="line">    <span class="keyword">int</span> keyLen;</div><div class="line">    <span class="keyword">int</span> valueStart;</div><div class="line">    <span class="keyword">char</span> c;</div><div class="line">    <span class="keyword">boolean</span> hasSep;</div><div class="line">    <span class="keyword">boolean</span> precedingBackslash;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> ((limit = lr.readLine()) &gt;= <span class="number">0</span>) &#123;</div><div class="line">        c = <span class="number">0</span>;</div><div class="line">        keyLen = <span class="number">0</span>;</div><div class="line">        valueStart = limit;</div><div class="line">        hasSep = <span class="keyword">false</span>;</div><div class="line"></div><div class="line">        <span class="comment">//System.out.println("line=&lt;" + new String(lineBuf, 0, limit) + "&gt;");</span></div><div class="line">        precedingBackslash = <span class="keyword">false</span>;</div><div class="line">        <span class="keyword">while</span> (keyLen &lt; limit) &#123;</div><div class="line">            c = lr.lineBuf[keyLen];</div><div class="line">            <span class="comment">//need check if escaped.</span></div><div class="line">            <span class="keyword">if</span> ((c == <span class="string">'='</span> ||  c == <span class="string">':'</span>) &amp;&amp; !precedingBackslash) &#123;</div><div class="line">                valueStart = keyLen + <span class="number">1</span>;</div><div class="line">                hasSep = <span class="keyword">true</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((c == <span class="string">' '</span> || c == <span class="string">'\t'</span> ||  c == <span class="string">'\f'</span>) &amp;&amp; !precedingBackslash) &#123;</div><div class="line">                valueStart = keyLen + <span class="number">1</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (c == <span class="string">'\\'</span>) &#123;</div><div class="line">                precedingBackslash = !precedingBackslash;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                precedingBackslash = <span class="keyword">false</span>;</div><div class="line">            &#125;</div><div class="line">            keyLen++;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> (valueStart &lt; limit) &#123;</div><div class="line">            c = lr.lineBuf[valueStart];</div><div class="line">            <span class="keyword">if</span> (c != <span class="string">' '</span> &amp;&amp; c != <span class="string">'\t'</span> &amp;&amp;  c != <span class="string">'\f'</span>) &#123;</div><div class="line">                <span class="keyword">if</span> (!hasSep &amp;&amp; (c == <span class="string">'='</span> ||  c == <span class="string">':'</span>)) &#123;</div><div class="line">                    hasSep = <span class="keyword">true</span>;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            valueStart++;</div><div class="line">        &#125;</div><div class="line">        String key = loadConvert(lr.lineBuf, <span class="number">0</span>, keyLen, convtBuf);</div><div class="line">        String value = loadConvert(lr.lineBuf, valueStart, limit - valueStart, convtBuf);</div><div class="line">        put(key, value);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上面的这一段代码看上去显得好复杂啊，我们不想要看懂，只是看到它使用了inStream构造了内部类LineReader，最后在一个可爱的while循环里将值put到了自身也就是一个HashTable中去，至此，我们就可以getProperty()方法拿到我们需要的东西了，其实，getProperty（）方法只是对get()方法在次做了封装，为的就是更加直观啊，你说对吧！看代码：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">public String getProperty(String key) &#123;</div><div class="line">        Object oval = super.get(key);</div><div class="line">        String sval = (oval instanceof String) ? (String)oval : null;</div><div class="line">        return ((sval == null) &amp;&amp; (defaults != null)) ? defaults.getProperty(key) : sval;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;今天我们本来只是想搞定一下proterties文件的用法的，结果发现了Proterties类的作者和我们的想法竟然不谋而合。基于这样的想法，我们还可以构造出属于自己的配置文件读取类，当然，如果你确实有那样的需求，尽管去折腾。<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;看来，多折腾才是王道！今天对protertis文件的分享就到这里了。</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/klugjo/hexo-theme-clean-blog" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>